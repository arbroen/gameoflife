[coverage:run]
branch = True
source =
    gol
omit =
    */__version__.py
    */start.py

[coverage:paths]
source =
   src/gol
   .tox/*/lib/python*/site-packages/gol
   .tox/pypy*/site-packages/gol

# Black advises a line-length of 88.
[flake8]
max-complexity = 10
max-line-length = 88

[isort]
include_trailing_comma = true
multi_line_output = 3

[tox]
isolated_build = true
envlist = py37, py38, py39, pypy3, report, linters

[testenv]
list_dependencies_command = poetry run pip list --format json -l
whitelist_externals =
    poetry
extras =
    testing
setenv =
    LANG=en_US.utf-8
    LC_ALL=en_US.utf-8
commands =
    poetry run coverage run -m pytest {posargs}

[testenv:report]
depends =
    py37
    py38
    pyp39
    pypy3
commands =
    poetry run coverage combine
    poetry run coverage report
    poetry run coverage html

[testenv:linters]
description = Apply various tools, see project.toml[extras::linters]
basepython = python3.8
extras = linters
commands =
    poetry run bandit -r src/gol/
    poetry run black src/ tests/ --check
    poetry run flake8
    poetry run isort --recursive src tests
    poetry run safety check